# Data Mining Project — Flight Price Regression

This repository contains a series of Jupyter notebooks that build, train, and evaluate regression models (Baseline, Linear/Regularized, KNN, Random Forest, XGBoost, Neural Network) to predict flight prices ([subset from this dataset](https://www.kaggle.com/datasets/dilwong/flightprices)). The workflow is organized into numbered notebooks from preprocessing to final evaluation.

## Folder & File Structure

- `01_Preprocessing.ipynb` — Data cleaning, feature engineering, train/test split preparation.
- `02_Baseline.ipynb` — Simple baseline models and baseline metrics.
- `03_Regression_Models.ipynb` — Linear and regularized regression models, experiments and tuning.
- `04_KNN_Regression.ipynb` — KNN regression, tuning and evaluation.
- `05_Random_Forest_Regression.ipynb` — Tree-based ensemble model, tuning and evaluation.
- `06_XGBoost_Regression.ipynb` — Gradient boosting with XGBoost, tuning and evaluation.
- `07_NN_Regression.ipynb` — Neural network model using TensorFlow/Keras, tuning and training.
- `08_Evaluation.ipynb` — Consolidates results, compares models, and generates final evaluation outputs.
- `Pipfile` — Python dependencies managed by pipenv (Python 3.12).
- `Pipfile.lock` — Locked dependency versions (auto-generated by pipenv).
- `data/`
  - `train_data.csv` — Training dataset produced by preprocessing.
  - `test_data.csv` — Test dataset produced by preprocessing.
  - `nonstop_flights.csv` — Source dataset used during preprocessing.
  - `baseline_results.csv` — Saved metrics from the baseline notebook.
  - `evaluation_results.csv` — Metrics from model comparison.
- `models/`
  - `scaler.pkl` 
  - `ols_pipeline.pkl` 
  - `ridge_pipeline.pkl` 
  - `lasso_pipeline.pkl`
  - `knn_uniform.pkl`
  - `knn_distance.pkl` 
  - `random_forest_model.pkl`
  - `xgboost_regressor.pkl`
  - `neural_network.keras` 

## Prerequisites

- Python 3.12
- pipenv for environment and dependency management

### Install pipenv

**macOS / Linux:**
```zsh
# Option A: Homebrew (macOS)
brew install pipenv

# Option B: pip
python3 -m pip install --user pipenv
```

**Windows:**
```powershell
# Open PowerShell or Command Prompt
pip install pipenv

# Note: You may need to add the Python scripts folder to your system PATH
# if the command 'pipenv' is not found after installation.
```

**Verify Installation:**
```bash
pipenv --version
```

## Setup the Project Environment

From the project root:

**macOS / Linux:**
```zsh
# Ensure you're using Python 3.12
python3 --version

# Create the pipenv environment
pipenv install --python 3.12

# Activate the environment
pipenv shell
```

**Windows:**
```powershell
# Ensure you're using Python 3.12
python --version
# OR if using the py launcher:
py --list

# Create the pipenv environment (uses packages from Pipfile)
pipenv install --python 3.12

# Activate the environment
pipenv shell
```

This will install the dependencies listed in `Pipfile`.

```bash
pipenv sync
```

## Running the Notebooks

1. Activate the pipenv shell if not already active:
   ```bash
   pipenv shell
   ```
2. Launch Jupyter Notebook:
   ```bash
   jupyter notebook
   ```
3. Open each notebook in order and run all cells:
   - `01_Preprocessing.ipynb`
   - `02_Baseline.ipynb`
   - `03_Regression_Models.ipynb`
   - `04_KNN_Regression.ipynb`
   - `05_Random_Forest_Regression.ipynb`
   - `06_XGBoost_Regression.ipynb`
   - `07_NN_Regression.ipynb`
   - `08_Evaluation.ipynb`

### Notes
- The preprocessing notebook generates `train_data.csv` and `test_data.csv` by transforming `nonstop_flights.csv`.